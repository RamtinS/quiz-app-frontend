name: CI

on:
  push:
    #branches: [ "development" ]
  pull_request:
    #branches: [ "development" ]

permissions: write-all
jobs:
  prettier:
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      runs-on: ubuntu-latest

      steps:
      - uses: actions/checkout@v3

        # Setup NodeJS
      - name: Setup Node.js 20
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'npm'
  
      # Configure authenticated user, so CI can write to branch
      - name: Configure Git

      # Check with prettier and commit changes to branch.
      - name: Write
        run: |
          npx prettier . --write
          git add .
          git commit -m "Format code with Prettier"
          git push
    
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    # Setup NodeJS
    - name: Setup Node.js 20
      uses: actions/setup-node@v3
      with:
        node-version: '20'
        cache: 'npm'
        
    # Install dependencies
    - name: Install dependencies
      run: |
        npm ci

    # Build project
    - name: Build Project
      run: |
        npm run build


  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    # Setup NodeJS
    - name: Setup Node.js 20
      uses: actions/setup-node@v3
      with:
        node-version: '20'
        cache: 'npm'
        
    # Install dependencies
    - name: Install dependencies
      run: |
        npm ci

    # Build project
    - name: Build Project
      run: |
        npm test
    
